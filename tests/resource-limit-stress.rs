//= {"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"2":["",true],"1":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"},{"output":{"1":["",true],"2":["",true]},"children":[],"exit":"Success"}],"exit":"Success"}],"exit":"Success"}

#![allow(clippy::needless_update)]

use constellation::*;
use rand::{Rng, SeedableRng};
use rand_pcg::Pcg64Mcg as SmallRng;
use serde::{Deserialize, Serialize};
use std::env;

#[derive(Clone, Serialize, Deserialize)]
struct Node {
	mem: Mem,
	cpu: Cpu,
}
impl Node {
	fn fits(&self, process: &Resources) -> bool {
		process.mem <= self.mem && process.cpu <= self.cpu
	}

	fn alloc(&mut self, process: &Resources) {
		assert!(process.cpu <= self.cpu);
		self.mem -= process.mem;
		self.cpu -= process.cpu;
	}

	fn free(&mut self, process: &Resources) {
		self.mem += process.mem;
		self.cpu += process.cpu;
	}
}

fn main() {
	let resources = Resources {
		mem: 20 * Mem::MIB,
		..Resources::default()
	};
	init(resources);
	let rng = SmallRng::seed_from_u64(0);
	let round = 0;
	let mut nodes = vec![
		Node {
			mem: 2 * Mem::GIB,
			cpu: 2 * Cpu::CORE,
		},
		Node {
			mem: Mem::GIB,
			cpu: Cpu::CORE,
		},
		Node {
			mem: Mem::GIB / 2,
			cpu: Cpu::CORE / 2,
		},
	];
	nodes[0].alloc(&resources);
	let processes = vec![Process {
		node: 0,
		resources,
		pid: pid(),
		sender: None,
		receiver: None,
	}];
	run(rng, round, nodes, processes);
}

struct Process {
	node: usize,
	resources: Resources,
	pid: Pid,
	sender: Option<Sender<Pid>>,
	receiver: Option<Receiver<Pid>>,
}

fn run(mut rng: SmallRng, round: u64, mut nodes: Vec<Node>, mut processes: Vec<Process>) {
	let _fabric = env::var("CONSTELLATION") == Ok(String::from("fabric"));
	for round in round..1000 {
		let spawner = rng.gen_range(0, processes.len());
		let spawn_ = rng.gen() || processes.len() == 1;
		if spawn_ {
			let resources = Resources {
				mem: Mem::GIB / 2,
				cpu: Cpu::CORE / 1000,
				..Resources::default()
			};
			let node = nodes.iter().position(|node| node.fits(&resources));
			let node = if let Some(node) = node {
				node
			} else {
				// if fabric {
				// 	try_spawn(
				// 		Resources {
				// 			mem: Mem::GIB / 2,
				// 			cpu: Cpu::CORE / 1000,
				// 			..Resources::default()
				// 		},
				// 		FnOnce!(|_parent| ()),
				// 	)
				// 	.block()
				// 	.err()
				// 	.expect("spawn() should have failed");
				// }
				// TODO: need a barrier
				continue;
			};
			nodes[node].alloc(&resources);
			if processes[spawner].pid == pid() {
				let (rng, nodes, processes_) = (
					rng.clone(),
					nodes.clone(),
					processes
						.iter()
						.map(
							|&Process {
							     node,
							     resources,
							     pid,
							     ..
							 }| (node, resources, pid),
						)
						.collect::<Vec<_>>(),
				);
				let spawned_pid = spawn(
					resources,
					FnOnce!(move |_parent| {
						let mut processes = processes_
							.into_iter()
							.map(|(node, resources, pid)| Process {
								node,
								resources,
								pid,
								sender: None,
								receiver: None,
							})
							.collect::<Vec<_>>();
						processes.push(Process {
							node,
							resources: self::resources(),
							pid: pid(),
							sender: None,
							receiver: None,
						});
						run(rng, round + 1, nodes, processes);
					}),
				)
				.block()
				.expect("spawn() failed to allocate process");
				for &mut Process {
					pid,
					ref mut sender,
					..
				} in &mut processes
				{
					if pid == self::pid() {
						continue;
					}
					*sender = Some(sender.take().unwrap_or_else(|| Sender::new(pid)));
					sender.as_ref().unwrap().send(spawned_pid).block();
				}
				processes.push(Process {
					node,
					resources,
					pid: spawned_pid,
					sender: None,
					receiver: None,
				});
			} else {
				let spawner = &mut processes[spawner];
				let spawner_pid = spawner.pid;
				let receiver = &mut spawner.receiver;
				*receiver = Some(
					receiver
						.take()
						.unwrap_or_else(|| Receiver::new(spawner_pid)),
				);
				let spawned_pid = receiver.as_ref().unwrap().recv().block().unwrap();
				processes.push(Process {
					node,
					resources,
					pid: spawned_pid,
					sender: None,
					receiver: None,
				});
			}
		} else {
			if processes[spawner].pid == pid() {
				return;
			}
			let Process {
				node, resources, ..
			} = processes.remove(spawner);
			nodes[node].free(&resources);
		}
	}
}
